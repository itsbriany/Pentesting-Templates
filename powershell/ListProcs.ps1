function List-Procs {
    $procs = Get-CimInstance Win32_Process
    $results = ForEach ($p in $procs) {
        $owner = Invoke-CimMethod -InputObject $p -MethodName GetOwner
        $result = New-Object -TypeName PsObject
        $result | Add-Member -MemberType NoteProperty 'PID' $p.ProcessId
        $result | Add-Member -MemberType NoteProperty 'PPID' $p.ParentProcessId
        $result | Add-Member -MemberType NoteProperty 'ProcessName' $p.ProcessName
        $result | Add-Member -MemberType NoteProperty 'Domain' $owner.Domain
        $result | Add-Member -MemberType NoteProperty 'User' $owner.User
        $result | Add-Member -MemberType NoteProperty 'ComputerName' $owner.PSComputerName
        $result
    }
    $results | Format-Table -Wrap
}
List-Procs
