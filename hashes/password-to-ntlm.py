import argparse
import hashlib
import binascii

def run(args):
    h = hashlib.new('md4', args.password.encode('utf-16le')).digest()
    print(binascii.hexlify(h).decode('utf-8'))

if __name__ == '__main__':
    parser = argparse.ArgumentParser(description='Make an NTLM hash from a password.')
    parser.add_argument('--password', dest='password', type=str, help='the password to hash', required=True)

    try:
        args = parser.parse_args()
        run(args)
    except argparse.ArgumentError as e:
        print("[!] {}".format(e))
        parser.print_usage()
        sys.exit(1)
